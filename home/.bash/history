# Only run if we're being sourced
if [ "${BASH_SOURCE[0]}" = "${0}" ]; then
  echo "This is meant to be sourced, not running" >&2
  exit 1
fi

# This appears to need to be run on every invocation?
# Force prompt to write history after every command.
# http://superuser.com/questions/20900/bash-history-loss
PROMPT_COMMAND="history -a; $PROMPT_COMMAND"

# Only allow this to be sourced once
check_var="DOTBASH_$(basename $(echo ${BASH_SOURCE} | tr '[a-z]' '[A-Z]'))"
[ -v ${check_var} ] && { unset check_var; return; }
export ${check_var}=1
unset check_var

# Unlimited bash history
export HISTCONTROL="ignoreboth"
export HISTFILESIZE=
export HISTSIZE=
# %F  Equivalent to %Y-%m-%d (the ISO 8601 date format). (C99)
# %T  The time in 24-hour notation (%H:%M:%S). (SU)
export HISTTIMEFORMAT="[%F %T] "
# Change the file location because certain bash sessions truncate .bash_history file upon close.
# http://superuser.com/questions/575479/bash-history-truncated-to-500-lines-on-each-login
export HISTFILE=~/.bash_eternal_history
